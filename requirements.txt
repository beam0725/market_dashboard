import streamlit as st
import yfinance as yf
import pandas as pd

st.set_page_config(page_title="跨國大盤指數儀表板", layout="wide")

st.title("🌐 跨國大盤指數走勢圖")

# 國別與指數
market_options = {
    "美國": {
        "S&P 500": "^GSPC",
        "Nasdaq": "^IXIC",
        "道瓊工業指數": "^DJI"
    },
    "台灣": {
        "加權指數": "^TWII"
    }
}

# 使用者介面
selected_country = st.selectbox("請選擇國家", list(market_options.keys()))
date_range = st.date_input("選擇日期區間", value=[pd.to_datetime("2023-01-01"), pd.to_datetime("today")])

start_date = date_range[0].strftime("%Y-%m-%d")
end_date = date_range[1].strftime("%Y-%m-%d")

st.subheader(f"{selected_country} 指數走勢")

for index_name, ticker in market_options[selected_country].items():
    df = yf.download(ticker, start=start_date, end=end_date)
    if not df.empty:
        st.line_chart(df['Close'], height=300, use_container_width=True)
    else:
        st.warning(f"無法取得 {index_name} 的資料")
